{"ast":null,"code":"import _regeneratorRuntime from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Table from'react-bootstrap/Table';import{Card}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function RetrievedDatasetVarTable(_ref){var selectedLabel=_ref.selectedLabel,kbUri=_ref.kbUri;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),varNames=_useState2[0],setVarNames=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),bindings=_useState4[0],setBindings=_useState4[1];function composeQuery(){return\" PREFIX skos: <http://www.w3.org/2004/02/skos/core#>\\n            PREFIX sosa: <http://www.w3.org/ns/sosa/> \\n            PREFIX ucmm: <http://purl.org/ucmm#> \\n            PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> \\n            PREFIX dcat: <http://www.w3.org/ns/dcat#> \\n            PREFIX dcterms: <http://purl.org/dc/terms/> \\n            SELECT DISTINCT ?dataset \\n            WHERE{ \\n              { \\n                ?dataset rdf:type dcat:Dataset . \\n                ?dataset ?p ?concept .  \\n                ?concept skos:prefLabel ?searchLabel .  \\n              }UNION{ \\n                ?dataset rdf:type dcat:Dataset . \\n                ?dataset dcterms:description|dcterms:title ?searchLabel.  \\n              }UNION{ \\n                ?dataset rdf:type dcat:Dataset . \\n                ?obsColl ucmm:hasAggregatedResult ?dataset . \\n                ?obsColl  (sosa:hasFeatureofInterest|sosa:hasUltimateFeatureofInterest) ?concept . \\n                ?concept skos:prefLabel ?searchLabel . \\n              }UNION{ \\n                ?dataset rdf:type dcat:Dataset .\\n                ?obsColl ucmm:hasAggregatedResult ?dataset . \\n                ?obsColl sosa:observedProperty ?concept . \\n                ?concept skos:prefLabel ?searchLabel . \\n              }\\n              FILTER ( \\n                regex(?searchLabel,\\\"\".concat(selectedLabel,\"\\\",\\\"i\\\") \\n              )\\n              FILTER (\\n                lang(?searchLabel)=\\\"en\\\"\\n              )\\n            }\").toString().replace('\\n',' ');}function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,jsonData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;console.log('kbUri : ',kbUri);console.log('selectedLabel : ',selectedLabel);console.log('composeQuery : ',composeQuery());_context.next=6;return fetch(kbUri,{method:\"POST\",credentials:\"same-origin\",headers:{\"Content-Type\":'application/x-www-form-urlencoded',\"xhrFields\":{withCredentials:true},\"Accept\":\"application/json\"},redirect:\"follow\",referrerPolicy:\"no-referrer\",body:\"query=\"+composeQuery()});case 6:response=_context.sent;_context.next=9;return response.json();case 9:jsonData=_context.sent;console.log('jsonData:',jsonData);if(jsonData){if(jsonData.results){if(jsonData.results.bindings){setBindings(jsonData.results.bindings);}}if(jsonData.head){if(jsonData.head.vars){setVarNames(jsonData.head.vars);}}}// console.log('varNames:', varNames); \n// console.log('bindings:', bindings);\n_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.log('Error:',_context.t0);case 17:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return _fetchData.apply(this,arguments);}useEffect(function(){if(selectedLabel!==''){fetchData();}},[selectedLabel]);return/*#__PURE__*/_jsx(Card,{children:varNames.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Card.Header,{children:selectedLabel}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,size:\"lg\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{\"text-align\":\"center\",children:varNames.map(function(v){return/*#__PURE__*/_jsxs(\"th\",{children:[\" \",\"\".concat(v,\"(s)\"),\" \"]});})})}),/*#__PURE__*/_jsx(\"tbody\",{children:bindings.map(function(binding){return/*#__PURE__*/_jsx(\"tr\",{children:varNames.map(function(varName){return/*#__PURE__*/_jsxs(\"td\",{children:[\" \",binding[varName][\"value\"],\" \"]});})});})})]})})]}):/*#__PURE__*/_jsxs(\"p\",{children:[\" \",\" Enter a search label and press the button: Retrieve Datasets \",\"  \"]})});}","map":{"version":3,"names":["useState","useEffect","Table","Card","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RetrievedDatasetVarTable","_ref","selectedLabel","kbUri","_useState","_useState2","_slicedToArray","varNames","setVarNames","_useState3","_useState4","bindings","setBindings","composeQuery","concat","toString","replace","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","jsonData","wrap","_callee$","_context","prev","next","console","log","fetch","method","credentials","headers","withCredentials","redirect","referrerPolicy","body","sent","json","results","head","vars","t0","stop","children","length","Header","Body","striped","bordered","hover","responsive","size","map","v","binding","varName"],"sources":["/home/vincentarmant/workspace/nodejs/react-restapi-call/src/components/bindingVarTable/RetrievedDatasetVarTable.js"],"sourcesContent":["import {useState,useEffect} from 'react'\nimport Table from 'react-bootstrap/Table';\nimport { Card } from 'react-bootstrap';\n\nexport default function RetrievedDatasetVarTable({selectedLabel, kbUri}){\n\n    \n    const [varNames,setVarNames] = useState([]);\n    const [bindings, setBindings] = useState([]);\n\n    \n    function composeQuery(){\n        return ` PREFIX skos: <http://www.w3.org/2004/02/skos/core#>\n            PREFIX sosa: <http://www.w3.org/ns/sosa/> \n            PREFIX ucmm: <http://purl.org/ucmm#> \n            PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> \n            PREFIX dcat: <http://www.w3.org/ns/dcat#> \n            PREFIX dcterms: <http://purl.org/dc/terms/> \n            SELECT DISTINCT ?dataset \n            WHERE{ \n              { \n                ?dataset rdf:type dcat:Dataset . \n                ?dataset ?p ?concept .  \n                ?concept skos:prefLabel ?searchLabel .  \n              }UNION{ \n                ?dataset rdf:type dcat:Dataset . \n                ?dataset dcterms:description|dcterms:title ?searchLabel.  \n              }UNION{ \n                ?dataset rdf:type dcat:Dataset . \n                ?obsColl ucmm:hasAggregatedResult ?dataset . \n                ?obsColl  (sosa:hasFeatureofInterest|sosa:hasUltimateFeatureofInterest) ?concept . \n                ?concept skos:prefLabel ?searchLabel . \n              }UNION{ \n                ?dataset rdf:type dcat:Dataset .\n                ?obsColl ucmm:hasAggregatedResult ?dataset . \n                ?obsColl sosa:observedProperty ?concept . \n                ?concept skos:prefLabel ?searchLabel . \n              }\n              FILTER ( \n                regex(?searchLabel,\"${selectedLabel}\",\"i\") \n              )\n              FILTER (\n                lang(?searchLabel)=\"en\"\n              )\n            }`.toString().replace('\\n',' ');\n    }\n\n    async function fetchData ()   {\n\n        try {  \n\n            console.log('kbUri : ',kbUri);\n            console.log('selectedLabel : ',selectedLabel);\n\n            console.log('composeQuery : ',composeQuery());\n\n            const response = await fetch(kbUri,{\n                method: \"POST\",\n                credentials: \"same-origin\",\n                headers:{\n                    \"Content-Type\": 'application/x-www-form-urlencoded',\n                    \"xhrFields\": {withCredentials: true},\n                    \"Accept\" : \"application/json\",\n                },\n                redirect: \"follow\",\n                referrerPolicy: \"no-referrer\",\n                body: \"query=\"+ composeQuery()\n            }\n            )            \n            \n            const jsonData = await response.json();\n            \n            console.log('jsonData:', jsonData);\n            \n            if(jsonData){\n\n                if(jsonData.results){\n                    if(jsonData.results.bindings){\n                        setBindings(jsonData.results.bindings);\n                    }}\n\n                if(jsonData.head){\n                    if(jsonData.head.vars){\n                        setVarNames(jsonData.head.vars);\n                    }\n                }\n                \n            }\n\n            // console.log('varNames:', varNames); \n            // console.log('bindings:', bindings);\n\n        } catch (error) {\n            console.log('Error:', error);\n            \n        }\n    }\n\n    useEffect (\n         () =>{\n            if(selectedLabel !== ''){\n                fetchData();\n            }\n        },\n        [selectedLabel]\n    );\n\n \n    return(\n        <Card>\n            {varNames.length>0 ?(\n                <>\n                    <Card.Header>\n                    {selectedLabel} \n                    </Card.Header>\n                    <Card.Body>\n                        <Table striped bordered hover responsive size='lg' >\n                            <thead >\n                                <tr text-align=\"center\">\n                                    {varNames.map(v => <th> {`${v}(s)`} </th> )}\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {bindings.map(binding =>\n                                    <tr>\n                                        {varNames.map(varName => \n                                            <td> {binding[varName][\"value\"]} </td>\n                                        )}\n                                    </tr>\n                                )}\n                            </tbody>\n                        </Table>\n                    </Card.Body> \n                </>\n            ):(\n                <p> {` Enter a search label and press the button: Retrieve Datasets `}  </p>\n            )}\n        </Card>  \n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}