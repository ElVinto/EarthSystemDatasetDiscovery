{"ast":null,"code":"import _regeneratorRuntime from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/vincentarmant/workspace/nodejs/react-restapi-call/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Table from'react-bootstrap/Table';import Button from'react-bootstrap/Button';import Form from'react-bootstrap/Form';import InputGroup from'react-bootstrap/InputGroup';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ExecQueryBindingVarTable(){var endpoint_uri='http://13.38.36.148:8080/rdf4j-server/repositories/ucmm_instance_graph';// const [varNames,setVarNames] = useState([\"s\",\"p\",\"o\"]);\n// const [bindings, setBindings] = useState([\n//     {s:{value: 's1'},p:{value: 'p1'},o:{value:'o1'}},\n//     {s:{value: 's2'},p:{value: 'p2'},o:{value:'o2'}}\n// ]);\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),varNames=_useState2[0],setVarNames=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),bindings=_useState4[0],setBindings=_useState4[1];var _useState5=useState(// \"SELECT * WHERE { ?s ?p ?o.  } limit 10\"\n'PREFIX skos: <http://www.w3.org/2004/02/skos/core#> '+'PREFIX sosa: <http://www.w3.org/ns/sosa/> '+'PREFIX ucmm: <http://purl.org/ucmm#> '+'PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> '+'PREFIX dcat: <http://www.w3.org/ns/dcat#> '+'PREFIX dcterms: <http://purl.org/dc/terms/> '+'SELECT DISTINCT ?dataset '+'WHERE{ '+'  { '+'    ?dataset rdf:type dcat:Dataset . '+'    ?dataset ?p ?concept . '+// ?p matches: dcterms:subject, dcterms:theme\n'    ?concept skos:prefLabel ?searchLabel .'+// ?p matches: dcterms:subject, dcterms:theme '+\n'  }UNION{ '+'    ?dataset rdf:type dcat:Dataset . '+'    ?dataset dcterms:description|dcterms:title ?searchLabel. '+'  }UNION{ '+'    ?dataset rdf:type dcat:Dataset . '+'    ?obsColl ucmm:hasAggregatedResult ?dataset . '+'    ?obsColl  (sosa:hasFeatureofInterest|sosa:hasUltimateFeatureofInterest) ?concept . '+'    ?concept skos:prefLabel ?searchLabel . '+'  }UNION{ '+'    ?dataset rdf:type dcat:Dataset .'+'    ?obsColl ucmm:hasAggregatedResult ?dataset .'+'    ?obsColl sosa:observedProperty ?concept .'+'    ?concept skos:prefLabel ?searchLabel .'+'  }'+'  FILTER ('+'    regex(?searchLabel,\"temperature\",\"i\") '+'  )'+'  FILTER ('+'    lang(?searchLabel)=\"en\"'+'  )'+'}'),_useState6=_slicedToArray(_useState5,2),queryTxt=_useState6[0],setQueryTxt=_useState6[1];function fetchData(_x,_x2){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url,d){var response,jsonData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(url,{method:\"POST\",credentials:\"same-origin\",headers:{\"Content-Type\":'application/x-www-form-urlencoded',\"xhrFields\":{withCredentials:true},\"Accept\":\"application/json\"},redirect:\"follow\",referrerPolicy:\"no-referrer\",body:\"query=\"+d.replaceAll('\\n',' ')});case 3:response=_context.sent;_context.next=6;return response.json();case 6:jsonData=_context.sent;console.log('jsonData:',jsonData);if(jsonData){if(jsonData.results){if(jsonData.results.bindings){setBindings(jsonData.results.bindings);}}if(jsonData.head){if(jsonData.head.vars){setVarNames(jsonData.head.vars);}}}console.log('varNames:',varNames);console.log('bindings:',bindings);// console.log('bindings[0][s][\"value\"]: ', bindings[0][varNames[0]][\"value\"]);\n// bindings.map(binding =>\n//     varNames.map(varName => {\n//         console.log(\"<td> \", binding[varName][\"value\"], \" </td>\")\n//         })\n// )\n_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log('Error:',_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return _fetchData.apply(this,arguments);}useEffect(function(){var resp=fetchData(endpoint_uri,queryTxt);},[]);function handleButtonClick(){fetchData(endpoint_uri,queryTxt).then(function(response){console.log(response);});}function execQuery(){return/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:\"Query: \"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:\"3\",type:\"text\",placeholder:queryTxt,value:queryTxt,onChange:function onChange(e){return setQueryTxt(e.target.value);}}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",id:\"button-addon\",onClick:handleButtonClick,children:\"execute query\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:execQuery()}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,size:\"lg\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{\"text-align\":\"center\",children:varNames.map(function(v){return/*#__PURE__*/_jsxs(\"th\",{children:[\" \",v,\" \"]});})})}),/*#__PURE__*/_jsx(\"tbody\",{children:bindings.map(function(binding){return/*#__PURE__*/_jsx(\"tr\",{children:varNames.map(function(varName){return/*#__PURE__*/_jsxs(\"td\",{children:[\" \",binding[varName][\"value\"],\" \"]});})});})})]})})]});}","map":{"version":3,"names":["useState","useEffect","Table","Button","Form","InputGroup","jsx","_jsx","jsxs","_jsxs","ExecQueryBindingVarTable","endpoint_uri","_useState","_useState2","_slicedToArray","varNames","setVarNames","_useState3","_useState4","bindings","setBindings","_useState5","_useState6","queryTxt","setQueryTxt","fetchData","_x","_x2","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","url","d","response","jsonData","wrap","_callee$","_context","prev","next","fetch","method","credentials","headers","withCredentials","redirect","referrerPolicy","body","replaceAll","sent","json","console","log","results","head","vars","t0","stop","resp","handleButtonClick","then","execQuery","className","children","Text","Control","as","rows","type","placeholder","value","onChange","e","target","variant","id","onClick","striped","bordered","hover","responsive","size","map","v","binding","varName"],"sources":["/home/vincentarmant/workspace/nodejs/react-restapi-call/src/components/bindingVarTable/ExecQueryBindingVarTable.js"],"sourcesContent":["import {useState,useEffect} from 'react'\nimport Table from 'react-bootstrap/Table';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport InputGroup from 'react-bootstrap/InputGroup';\n\nexport default function ExecQueryBindingVarTable(){\n\n    const endpoint_uri = 'http://13.38.36.148:8080/rdf4j-server/repositories/ucmm_instance_graph';\n    \n    // const [varNames,setVarNames] = useState([\"s\",\"p\",\"o\"]);\n    // const [bindings, setBindings] = useState([\n    //     {s:{value: 's1'},p:{value: 'p1'},o:{value:'o1'}},\n    //     {s:{value: 's2'},p:{value: 'p2'},o:{value:'o2'}}\n    // ]);\n\n    const [varNames,setVarNames] = useState([]);\n    const [bindings, setBindings] = useState([]);\n\n    const [queryTxt, setQueryTxt] = useState(\n        // \"SELECT * WHERE { ?s ?p ?o.  } limit 10\"\n        'PREFIX skos: <http://www.w3.org/2004/02/skos/core#> '+\n        'PREFIX sosa: <http://www.w3.org/ns/sosa/> '+\n        'PREFIX ucmm: <http://purl.org/ucmm#> '+\n        'PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> '+\n        'PREFIX dcat: <http://www.w3.org/ns/dcat#> '+\n        'PREFIX dcterms: <http://purl.org/dc/terms/> '+\n        'SELECT DISTINCT ?dataset '+\n        'WHERE{ '+\n        '  { '+\n        '    ?dataset rdf:type dcat:Dataset . '+\n        '    ?dataset ?p ?concept . '+ // ?p matches: dcterms:subject, dcterms:theme\n        '    ?concept skos:prefLabel ?searchLabel .'+ // ?p matches: dcterms:subject, dcterms:theme '+\n        '  }UNION{ '+\n        '    ?dataset rdf:type dcat:Dataset . '+\n        '    ?dataset dcterms:description|dcterms:title ?searchLabel. '+ \n        '  }UNION{ '+\n        '    ?dataset rdf:type dcat:Dataset . '+\n        '    ?obsColl ucmm:hasAggregatedResult ?dataset . '+\n        '    ?obsColl  (sosa:hasFeatureofInterest|sosa:hasUltimateFeatureofInterest) ?concept . '+\n        '    ?concept skos:prefLabel ?searchLabel . '+\n        '  }UNION{ '+\n        '    ?dataset rdf:type dcat:Dataset .'+\n        '    ?obsColl ucmm:hasAggregatedResult ?dataset .'+\n        '    ?obsColl sosa:observedProperty ?concept .'+\n        '    ?concept skos:prefLabel ?searchLabel .'+\n        '  }'+\n        '  FILTER ('+ \n        '    regex(?searchLabel,\"temperature\",\"i\") '+\n        '  )'+\n        '  FILTER ('+ \n        '    lang(?searchLabel)=\"en\"'+\n        '  )'+\n        '}'\n    );\n\n    async function  fetchData (url, d )  {\n        try {  \n            const response = await fetch(url,{\n                method: \"POST\",\n                credentials: \"same-origin\",\n                headers:{\n                    \"Content-Type\": 'application/x-www-form-urlencoded',\n                    \"xhrFields\": {withCredentials: true},\n                     \"Accept\" : \"application/json\",\n                },\n                redirect: \"follow\",\n                referrerPolicy: \"no-referrer\",\n                body: \"query=\"+ d.replaceAll('\\n',' ')\n            }\n            )            \n            \n            \n            const jsonData = await response.json();\n            \n            console.log('jsonData:', jsonData);\n            \n            if(jsonData){\n\n                if(jsonData.results){\n                    if(jsonData.results.bindings){\n                        setBindings(jsonData.results.bindings);\n                    }}\n\n                if(jsonData.head){\n                    if(jsonData.head.vars){\n                        setVarNames(jsonData.head.vars);\n                    }\n                }\n                \n            }\n\n            console.log('varNames:', varNames); \n            console.log('bindings:', bindings);\n\n            // console.log('bindings[0][s][\"value\"]: ', bindings[0][varNames[0]][\"value\"]);\n\n            // bindings.map(binding =>\n            //     varNames.map(varName => {\n            //         console.log(\"<td> \", binding[varName][\"value\"], \" </td>\")\n            //         })\n            // )\n\n        } catch (error) {\n            console.log('Error:', error);\n            \n        }\n    }\n\n    useEffect (\n         () =>{\n             const resp =  fetchData(endpoint_uri, queryTxt);\n        },\n        []\n    );\n\n    function handleButtonClick(){\n      fetchData(endpoint_uri, queryTxt).then( response => { console.log(response)});\n    }\n\n    function execQuery(){\n        return(\n            <InputGroup className=\"mb-3\">\n                <InputGroup.Text>{\"Query: \"}</InputGroup.Text>\n                <Form.Control \n                    as=\"textarea\" \n                    rows=\"3\"\n                    type='text'\n                    placeholder={queryTxt}\n                    value={queryTxt} \n                    onChange={e =>setQueryTxt(e.target.value)}\n                    />\n                <Button variant=\"outline-secondary\" id=\"button-addon\" onClick={handleButtonClick}>\n                execute query\n                </Button> \n            </InputGroup> \n        );\n    }\n\n    return(\n        <div>\n        <div>\n            {execQuery()}\n        </div>\n        <div>\n            {/* {varNames ?( */}\n                <Table striped bordered hover responsive size='lg' >\n                    <thead >\n                        <tr text-align=\"center\">\n                            {varNames.map(v => <th> {v} </th> )}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {bindings.map(binding =>\n                            <tr>\n                                {varNames.map(varName => \n                                    <td> {binding[varName][\"value\"]} </td>\n                                )}\n                            </tr>\n                        )}\n                    </tbody>\n\n                </Table>\n            {/* ):(\n                <p> Data not yet available ... </p>\n            )} */}\n        </div>\n        </div>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}